{"remainingRequest":"G:\\vs_workspace\\git_sxq\\lmnb-web\\node_modules\\babel-loader\\lib\\index.js!G:\\vs_workspace\\git_sxq\\lmnb-web\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!G:\\vs_workspace\\git_sxq\\lmnb-web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!G:\\vs_workspace\\git_sxq\\lmnb-web\\src\\views\\table\\drag-table.vue?vue&type=script&lang=js&","dependencies":[{"path":"G:\\vs_workspace\\git_sxq\\lmnb-web\\src\\views\\table\\drag-table.vue","mtime":1686317623676},{"path":"G:\\vs_workspace\\git_sxq\\lmnb-web\\babel.config.js","mtime":1697545098144},{"path":"G:\\vs_workspace\\git_sxq\\lmnb-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1686317881343},{"path":"G:\\vs_workspace\\git_sxq\\lmnb-web\\node_modules\\babel-loader\\lib\\index.js","mtime":1686317882159},{"path":"G:\\vs_workspace\\git_sxq\\lmnb-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1686317881343},{"path":"G:\\vs_workspace\\git_sxq\\lmnb-web\\node_modules\\vue-loader\\lib\\index.js","mtime":1686317877157}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9yZWdlbmVyYXRvclJ1bnRpbWUgZnJvbSAiRzovdnNfd29ya3NwYWNlL2dpdF9zeHEvbG1uYi13ZWIvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL3JlZ2VuZXJhdG9yUnVudGltZS5qcyI7CmltcG9ydCBfYXN5bmNUb0dlbmVyYXRvciBmcm9tICJHOi92c193b3Jrc3BhY2UvZ2l0X3N4cS9sbW5iLXdlYi9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vYXN5bmNUb0dlbmVyYXRvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5Lm1hcC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnNsaWNlLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuc3BsaWNlLmpzIjsKLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IGZldGNoTGlzdCB9IGZyb20gJ0AvYXBpL2FydGljbGUnOwppbXBvcnQgU29ydGFibGUgZnJvbSAnc29ydGFibGVqcyc7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnRHJhZ1RhYmxlJywKICBmaWx0ZXJzOiB7CiAgICBzdGF0dXNGaWx0ZXI6IGZ1bmN0aW9uIHN0YXR1c0ZpbHRlcihzdGF0dXMpIHsKICAgICAgdmFyIHN0YXR1c01hcCA9IHsKICAgICAgICBwdWJsaXNoZWQ6ICdzdWNjZXNzJywKICAgICAgICBkcmFmdDogJ2luZm8nLAogICAgICAgIGRlbGV0ZWQ6ICdkYW5nZXInCiAgICAgIH07CiAgICAgIHJldHVybiBzdGF0dXNNYXBbc3RhdHVzXTsKICAgIH0KICB9LAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBsaXN0OiBudWxsLAogICAgICB0b3RhbDogbnVsbCwKICAgICAgbGlzdExvYWRpbmc6IHRydWUsCiAgICAgIGxpc3RRdWVyeTogewogICAgICAgIHBhZ2U6IDEsCiAgICAgICAgbGltaXQ6IDEwCiAgICAgIH0sCiAgICAgIHNvcnRhYmxlOiBudWxsLAogICAgICBvbGRMaXN0OiBbXSwKICAgICAgbmV3TGlzdDogW10KICAgIH07CiAgfSwKICBjcmVhdGVkOiBmdW5jdGlvbiBjcmVhdGVkKCkgewogICAgdGhpcy5nZXRMaXN0KCk7CiAgfSwKICBtZXRob2RzOiB7CiAgICBnZXRMaXN0OiBmdW5jdGlvbiBnZXRMaXN0KCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlKCkgewogICAgICAgIHZhciBfeWllbGQkZmV0Y2hMaXN0LCBkYXRhOwogICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgICAgd2hpbGUgKDEpIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIF90aGlzLmxpc3RMb2FkaW5nID0gdHJ1ZTsKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMzsKICAgICAgICAgICAgICByZXR1cm4gZmV0Y2hMaXN0KF90aGlzLmxpc3RRdWVyeSk7CiAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICBfeWllbGQkZmV0Y2hMaXN0ID0gX2NvbnRleHQuc2VudDsKICAgICAgICAgICAgICBkYXRhID0gX3lpZWxkJGZldGNoTGlzdC5kYXRhOwogICAgICAgICAgICAgIF90aGlzLmxpc3QgPSBkYXRhLml0ZW1zOwogICAgICAgICAgICAgIF90aGlzLnRvdGFsID0gZGF0YS50b3RhbDsKICAgICAgICAgICAgICBfdGhpcy5saXN0TG9hZGluZyA9IGZhbHNlOwogICAgICAgICAgICAgIF90aGlzLm9sZExpc3QgPSBfdGhpcy5saXN0Lm1hcChmdW5jdGlvbiAodikgewogICAgICAgICAgICAgICAgcmV0dXJuIHYuaWQ7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgX3RoaXMubmV3TGlzdCA9IF90aGlzLm9sZExpc3Quc2xpY2UoKTsKICAgICAgICAgICAgICBfdGhpcy4kbmV4dFRpY2soZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgX3RoaXMuc2V0U29ydCgpOwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICBjYXNlIDExOgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZSk7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIHNldFNvcnQ6IGZ1bmN0aW9uIHNldFNvcnQoKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwogICAgICB2YXIgZWwgPSB0aGlzLiRyZWZzLmRyYWdUYWJsZS4kZWwucXVlcnlTZWxlY3RvckFsbCgnLmVsLXRhYmxlX19ib2R5LXdyYXBwZXIgPiB0YWJsZSA+IHRib2R5JylbMF07CiAgICAgIHRoaXMuc29ydGFibGUgPSBTb3J0YWJsZS5jcmVhdGUoZWwsIHsKICAgICAgICBnaG9zdENsYXNzOiAnc29ydGFibGUtZ2hvc3QnLAogICAgICAgIC8vIENsYXNzIG5hbWUgZm9yIHRoZSBkcm9wIHBsYWNlaG9sZGVyLAogICAgICAgIHNldERhdGE6IGZ1bmN0aW9uIHNldERhdGEoZGF0YVRyYW5zZmVyKSB7CiAgICAgICAgICAvLyB0byBhdm9pZCBGaXJlZm94IGJ1ZwogICAgICAgICAgLy8gRGV0YWlsIHNlZSA6IGh0dHBzOi8vZ2l0aHViLmNvbS9SdWJhWGEvU29ydGFibGUvaXNzdWVzLzEwMTIKICAgICAgICAgIGRhdGFUcmFuc2Zlci5zZXREYXRhKCdUZXh0JywgJycpOwogICAgICAgIH0sCiAgICAgICAgb25FbmQ6IGZ1bmN0aW9uIG9uRW5kKGV2dCkgewogICAgICAgICAgdmFyIHRhcmdldFJvdyA9IF90aGlzMi5saXN0LnNwbGljZShldnQub2xkSW5kZXgsIDEpWzBdOwogICAgICAgICAgX3RoaXMyLmxpc3Quc3BsaWNlKGV2dC5uZXdJbmRleCwgMCwgdGFyZ2V0Um93KTsKCiAgICAgICAgICAvLyBmb3Igc2hvdyB0aGUgY2hhbmdlcywgeW91IGNhbiBkZWxldGUgaW4geW91IGNvZGUKICAgICAgICAgIHZhciB0ZW1wSW5kZXggPSBfdGhpczIubmV3TGlzdC5zcGxpY2UoZXZ0Lm9sZEluZGV4LCAxKVswXTsKICAgICAgICAgIF90aGlzMi5uZXdMaXN0LnNwbGljZShldnQubmV3SW5kZXgsIDAsIHRlbXBJbmRleCk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICB9Cn07"},{"version":3,"names":["fetchList","Sortable","name","filters","statusFilter","status","statusMap","published","draft","deleted","data","list","total","listLoading","listQuery","page","limit","sortable","oldList","newList","created","getList","methods","_this","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_yield$fetchList","wrap","_callee$","_context","prev","next","sent","items","map","v","id","slice","$nextTick","setSort","stop","_this2","el","$refs","dragTable","$el","querySelectorAll","create","ghostClass","setData","dataTransfer","onEnd","evt","targetRow","splice","oldIndex","newIndex","tempIndex"],"sources":["src/views/table/drag-table.vue"],"sourcesContent":["<template>\r\n  <div class=\"app-container\">\r\n    <!-- Note that row-key is necessary to get a correct row order. -->\r\n    <el-table ref=\"dragTable\" v-loading=\"listLoading\" :data=\"list\" row-key=\"id\" border fit highlight-current-row style=\"width: 100%\">\r\n      <el-table-column align=\"center\" label=\"ID\" width=\"65\">\r\n        <template slot-scope=\"{row}\">\r\n          <span>{{ row.id }}</span>\r\n        </template>\r\n      </el-table-column>\r\n\r\n      <el-table-column width=\"180px\" align=\"center\" label=\"Date\">\r\n        <template slot-scope=\"{row}\">\r\n          <span>{{ row.timestamp | parseTime('{y}-{m}-{d} {h}:{i}') }}</span>\r\n        </template>\r\n      </el-table-column>\r\n\r\n      <el-table-column min-width=\"300px\" label=\"Title\">\r\n        <template slot-scope=\"{row}\">\r\n          <span>{{ row.title }}</span>\r\n        </template>\r\n      </el-table-column>\r\n\r\n      <el-table-column width=\"110px\" align=\"center\" label=\"Author\">\r\n        <template slot-scope=\"{row}\">\r\n          <span>{{ row.author }}</span>\r\n        </template>\r\n      </el-table-column>\r\n\r\n      <el-table-column width=\"100px\" label=\"Importance\">\r\n        <template slot-scope=\"{row}\">\r\n          <svg-icon v-for=\"n in + row.importance\" :key=\"n\" icon-class=\"star\" class=\"icon-star\" />\r\n        </template>\r\n      </el-table-column>\r\n\r\n      <el-table-column align=\"center\" label=\"Readings\" width=\"95\">\r\n        <template slot-scope=\"{row}\">\r\n          <span>{{ row.pageviews }}</span>\r\n        </template>\r\n      </el-table-column>\r\n\r\n      <el-table-column class-name=\"status-col\" label=\"Status\" width=\"110\">\r\n        <template slot-scope=\"{row}\">\r\n          <el-tag :type=\"row.status | statusFilter\">\r\n            {{ row.status }}\r\n          </el-tag>\r\n        </template>\r\n      </el-table-column>\r\n\r\n      <el-table-column align=\"center\" label=\"Drag\" width=\"80\">\r\n        <template slot-scope=\"{}\">\r\n          <svg-icon class=\"drag-handler\" icon-class=\"drag\" />\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n    <!-- $t is vue-i18n global function to translate lang (lang in @/lang)  -->\r\n    <div class=\"show-d\">\r\n      <el-tag style=\"margin-right:12px;\">{{ $t('table.dragTips1') }} :</el-tag> {{ oldList }}\r\n    </div>\r\n    <div class=\"show-d\">\r\n      <el-tag>{{ $t('table.dragTips2') }} :</el-tag> {{ newList }}\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { fetchList } from '@/api/article'\r\nimport Sortable from 'sortablejs'\r\n\r\nexport default {\r\n  name: 'DragTable',\r\n  filters: {\r\n    statusFilter(status) {\r\n      const statusMap = {\r\n        published: 'success',\r\n        draft: 'info',\r\n        deleted: 'danger'\r\n      }\r\n      return statusMap[status]\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      list: null,\r\n      total: null,\r\n      listLoading: true,\r\n      listQuery: {\r\n        page: 1,\r\n        limit: 10\r\n      },\r\n      sortable: null,\r\n      oldList: [],\r\n      newList: []\r\n    }\r\n  },\r\n  created() {\r\n    this.getList()\r\n  },\r\n  methods: {\r\n    async getList() {\r\n      this.listLoading = true\r\n      const { data } = await fetchList(this.listQuery)\r\n      this.list = data.items\r\n      this.total = data.total\r\n      this.listLoading = false\r\n      this.oldList = this.list.map(v => v.id)\r\n      this.newList = this.oldList.slice()\r\n      this.$nextTick(() => {\r\n        this.setSort()\r\n      })\r\n    },\r\n    setSort() {\r\n      const el = this.$refs.dragTable.$el.querySelectorAll('.el-table__body-wrapper > table > tbody')[0]\r\n      this.sortable = Sortable.create(el, {\r\n        ghostClass: 'sortable-ghost', // Class name for the drop placeholder,\r\n        setData: function(dataTransfer) {\r\n          // to avoid Firefox bug\r\n          // Detail see : https://github.com/RubaXa/Sortable/issues/1012\r\n          dataTransfer.setData('Text', '')\r\n        },\r\n        onEnd: evt => {\r\n          const targetRow = this.list.splice(evt.oldIndex, 1)[0]\r\n          this.list.splice(evt.newIndex, 0, targetRow)\r\n\r\n          // for show the changes, you can delete in you code\r\n          const tempIndex = this.newList.splice(evt.oldIndex, 1)[0]\r\n          this.newList.splice(evt.newIndex, 0, tempIndex)\r\n        }\r\n      })\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style>\r\n.sortable-ghost{\r\n  opacity: .8;\r\n  color: #fff!important;\r\n  background: #42b983!important;\r\n}\r\n</style>\r\n\r\n<style scoped>\r\n.icon-star{\r\n  margin-right:2px;\r\n}\r\n.drag-handler{\r\n  width: 20px;\r\n  height: 20px;\r\n  cursor: pointer;\r\n}\r\n.show-d{\r\n  margin-top: 15px;\r\n}\r\n</style>\r\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiEA,SAAAA,SAAA;AACA,OAAAC,QAAA;AAEA;EACAC,IAAA;EACAC,OAAA;IACAC,YAAA,WAAAA,aAAAC,MAAA;MACA,IAAAC,SAAA;QACAC,SAAA;QACAC,KAAA;QACAC,OAAA;MACA;MACA,OAAAH,SAAA,CAAAD,MAAA;IACA;EACA;EACAK,IAAA,WAAAA,KAAA;IACA;MACAC,IAAA;MACAC,KAAA;MACAC,WAAA;MACAC,SAAA;QACAC,IAAA;QACAC,KAAA;MACA;MACAC,QAAA;MACAC,OAAA;MACAC,OAAA;IACA;EACA;EACAC,OAAA,WAAAA,QAAA;IACA,KAAAC,OAAA;EACA;EACAC,OAAA;IACAD,OAAA,WAAAA,QAAA;MAAA,IAAAE,KAAA;MAAA,OAAAC,iBAAA,eAAAC,mBAAA,GAAAC,IAAA,UAAAC,QAAA;QAAA,IAAAC,gBAAA,EAAAlB,IAAA;QAAA,OAAAe,mBAAA,GAAAI,IAAA,UAAAC,SAAAC,QAAA;UAAA,kBAAAA,QAAA,CAAAC,IAAA,GAAAD,QAAA,CAAAE,IAAA;YAAA;cACAV,KAAA,CAAAV,WAAA;cAAAkB,QAAA,CAAAE,IAAA;cAAA,OACAjC,SAAA,CAAAuB,KAAA,CAAAT,SAAA;YAAA;cAAAc,gBAAA,GAAAG,QAAA,CAAAG,IAAA;cAAAxB,IAAA,GAAAkB,gBAAA,CAAAlB,IAAA;cACAa,KAAA,CAAAZ,IAAA,GAAAD,IAAA,CAAAyB,KAAA;cACAZ,KAAA,CAAAX,KAAA,GAAAF,IAAA,CAAAE,KAAA;cACAW,KAAA,CAAAV,WAAA;cACAU,KAAA,CAAAL,OAAA,GAAAK,KAAA,CAAAZ,IAAA,CAAAyB,GAAA,WAAAC,CAAA;gBAAA,OAAAA,CAAA,CAAAC,EAAA;cAAA;cACAf,KAAA,CAAAJ,OAAA,GAAAI,KAAA,CAAAL,OAAA,CAAAqB,KAAA;cACAhB,KAAA,CAAAiB,SAAA;gBACAjB,KAAA,CAAAkB,OAAA;cACA;YAAA;YAAA;cAAA,OAAAV,QAAA,CAAAW,IAAA;UAAA;QAAA,GAAAf,OAAA;MAAA;IACA;IACAc,OAAA,WAAAA,QAAA;MAAA,IAAAE,MAAA;MACA,IAAAC,EAAA,QAAAC,KAAA,CAAAC,SAAA,CAAAC,GAAA,CAAAC,gBAAA;MACA,KAAA/B,QAAA,GAAAhB,QAAA,CAAAgD,MAAA,CAAAL,EAAA;QACAM,UAAA;QAAA;QACAC,OAAA,WAAAA,QAAAC,YAAA;UACA;UACA;UACAA,YAAA,CAAAD,OAAA;QACA;QACAE,KAAA,WAAAA,MAAAC,GAAA;UACA,IAAAC,SAAA,GAAAZ,MAAA,CAAAhC,IAAA,CAAA6C,MAAA,CAAAF,GAAA,CAAAG,QAAA;UACAd,MAAA,CAAAhC,IAAA,CAAA6C,MAAA,CAAAF,GAAA,CAAAI,QAAA,KAAAH,SAAA;;UAEA;UACA,IAAAI,SAAA,GAAAhB,MAAA,CAAAxB,OAAA,CAAAqC,MAAA,CAAAF,GAAA,CAAAG,QAAA;UACAd,MAAA,CAAAxB,OAAA,CAAAqC,MAAA,CAAAF,GAAA,CAAAI,QAAA,KAAAC,SAAA;QACA;MACA;IACA;EACA;AACA"}]}