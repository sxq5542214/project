{"remainingRequest":"H:\\workspaces\\vueProject\\lm\\node_modules\\babel-loader\\lib\\index.js!H:\\workspaces\\vueProject\\lm\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!H:\\workspaces\\vueProject\\lm\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!H:\\workspaces\\vueProject\\lm\\src\\views\\table\\drag-table.vue?vue&type=script&lang=js&","dependencies":[{"path":"H:\\workspaces\\vueProject\\lm\\src\\views\\table\\drag-table.vue","mtime":1686317623676},{"path":"H:\\workspaces\\vueProject\\lm\\babel.config.js","mtime":1686317623477},{"path":"H:\\workspaces\\vueProject\\lm\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1686317881343},{"path":"H:\\workspaces\\vueProject\\lm\\node_modules\\babel-loader\\lib\\index.js","mtime":1686317882159},{"path":"H:\\workspaces\\vueProject\\lm\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1686317881343},{"path":"H:\\workspaces\\vueProject\\lm\\node_modules\\vue-loader\\lib\\index.js","mtime":1686317877157}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9yZWdlbmVyYXRvclJ1bnRpbWUgZnJvbSAiSDovd29ya3NwYWNlcy92dWVQcm9qZWN0L2xtL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9yZWdlbmVyYXRvclJ1bnRpbWUuanMiOwppbXBvcnQgX2FzeW5jVG9HZW5lcmF0b3IgZnJvbSAiSDovd29ya3NwYWNlcy92dWVQcm9qZWN0L2xtL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9hc3luY1RvR2VuZXJhdG9yLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkubWFwLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuc2xpY2UuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zcGxpY2UuanMiOwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwoKaW1wb3J0IHsgZmV0Y2hMaXN0IH0gZnJvbSAnQC9hcGkvYXJ0aWNsZSc7CmltcG9ydCBTb3J0YWJsZSBmcm9tICdzb3J0YWJsZWpzJzsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdEcmFnVGFibGUnLAogIGZpbHRlcnM6IHsKICAgIHN0YXR1c0ZpbHRlcjogZnVuY3Rpb24gc3RhdHVzRmlsdGVyKHN0YXR1cykgewogICAgICB2YXIgc3RhdHVzTWFwID0gewogICAgICAgIHB1Ymxpc2hlZDogJ3N1Y2Nlc3MnLAogICAgICAgIGRyYWZ0OiAnaW5mbycsCiAgICAgICAgZGVsZXRlZDogJ2RhbmdlcicKICAgICAgfTsKICAgICAgcmV0dXJuIHN0YXR1c01hcFtzdGF0dXNdOwogICAgfQogIH0sCiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGxpc3Q6IG51bGwsCiAgICAgIHRvdGFsOiBudWxsLAogICAgICBsaXN0TG9hZGluZzogdHJ1ZSwKICAgICAgbGlzdFF1ZXJ5OiB7CiAgICAgICAgcGFnZTogMSwKICAgICAgICBsaW1pdDogMTAKICAgICAgfSwKICAgICAgc29ydGFibGU6IG51bGwsCiAgICAgIG9sZExpc3Q6IFtdLAogICAgICBuZXdMaXN0OiBbXQogICAgfTsKICB9LAogIGNyZWF0ZWQ6IGZ1bmN0aW9uIGNyZWF0ZWQoKSB7CiAgICB0aGlzLmdldExpc3QoKTsKICB9LAogIG1ldGhvZHM6IHsKICAgIGdldExpc3Q6IGZ1bmN0aW9uIGdldExpc3QoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUoKS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoKSB7CiAgICAgICAgdmFyIF95aWVsZCRmZXRjaExpc3QsIGRhdGE7CiAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUoKS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgICB3aGlsZSAoMSkgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgX3RoaXMubGlzdExvYWRpbmcgPSB0cnVlOwogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAzOwogICAgICAgICAgICAgIHJldHVybiBmZXRjaExpc3QoX3RoaXMubGlzdFF1ZXJ5KTsKICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgIF95aWVsZCRmZXRjaExpc3QgPSBfY29udGV4dC5zZW50OwogICAgICAgICAgICAgIGRhdGEgPSBfeWllbGQkZmV0Y2hMaXN0LmRhdGE7CiAgICAgICAgICAgICAgX3RoaXMubGlzdCA9IGRhdGEuaXRlbXM7CiAgICAgICAgICAgICAgX3RoaXMudG90YWwgPSBkYXRhLnRvdGFsOwogICAgICAgICAgICAgIF90aGlzLmxpc3RMb2FkaW5nID0gZmFsc2U7CiAgICAgICAgICAgICAgX3RoaXMub2xkTGlzdCA9IF90aGlzLmxpc3QubWFwKGZ1bmN0aW9uICh2KSB7CiAgICAgICAgICAgICAgICByZXR1cm4gdi5pZDsKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICBfdGhpcy5uZXdMaXN0ID0gX3RoaXMub2xkTGlzdC5zbGljZSgpOwogICAgICAgICAgICAgIF90aGlzLiRuZXh0VGljayhmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICBfdGhpcy5zZXRTb3J0KCk7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGNhc2UgMTE6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlKTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgc2V0U29ydDogZnVuY3Rpb24gc2V0U29ydCgpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CiAgICAgIHZhciBlbCA9IHRoaXMuJHJlZnMuZHJhZ1RhYmxlLiRlbC5xdWVyeVNlbGVjdG9yQWxsKCcuZWwtdGFibGVfX2JvZHktd3JhcHBlciA+IHRhYmxlID4gdGJvZHknKVswXTsKICAgICAgdGhpcy5zb3J0YWJsZSA9IFNvcnRhYmxlLmNyZWF0ZShlbCwgewogICAgICAgIGdob3N0Q2xhc3M6ICdzb3J0YWJsZS1naG9zdCcsCiAgICAgICAgLy8gQ2xhc3MgbmFtZSBmb3IgdGhlIGRyb3AgcGxhY2Vob2xkZXIsCiAgICAgICAgc2V0RGF0YTogZnVuY3Rpb24gc2V0RGF0YShkYXRhVHJhbnNmZXIpIHsKICAgICAgICAgIC8vIHRvIGF2b2lkIEZpcmVmb3ggYnVnCiAgICAgICAgICAvLyBEZXRhaWwgc2VlIDogaHR0cHM6Ly9naXRodWIuY29tL1J1YmFYYS9Tb3J0YWJsZS9pc3N1ZXMvMTAxMgogICAgICAgICAgZGF0YVRyYW5zZmVyLnNldERhdGEoJ1RleHQnLCAnJyk7CiAgICAgICAgfSwKICAgICAgICBvbkVuZDogZnVuY3Rpb24gb25FbmQoZXZ0KSB7CiAgICAgICAgICB2YXIgdGFyZ2V0Um93ID0gX3RoaXMyLmxpc3Quc3BsaWNlKGV2dC5vbGRJbmRleCwgMSlbMF07CiAgICAgICAgICBfdGhpczIubGlzdC5zcGxpY2UoZXZ0Lm5ld0luZGV4LCAwLCB0YXJnZXRSb3cpOwoKICAgICAgICAgIC8vIGZvciBzaG93IHRoZSBjaGFuZ2VzLCB5b3UgY2FuIGRlbGV0ZSBpbiB5b3UgY29kZQogICAgICAgICAgdmFyIHRlbXBJbmRleCA9IF90aGlzMi5uZXdMaXN0LnNwbGljZShldnQub2xkSW5kZXgsIDEpWzBdOwogICAgICAgICAgX3RoaXMyLm5ld0xpc3Quc3BsaWNlKGV2dC5uZXdJbmRleCwgMCwgdGVtcEluZGV4KTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0KfTs="},{"version":3,"names":["fetchList","Sortable","name","filters","statusFilter","status","statusMap","published","draft","deleted","data","list","total","listLoading","listQuery","page","limit","sortable","oldList","newList","created","getList","methods","_this","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_yield$fetchList","wrap","_callee$","_context","prev","next","sent","items","map","v","id","slice","$nextTick","setSort","stop","_this2","el","$refs","dragTable","$el","querySelectorAll","create","ghostClass","setData","dataTransfer","onEnd","evt","targetRow","splice","oldIndex","newIndex","tempIndex"],"sources":["src/views/table/drag-table.vue"],"sourcesContent":["<template>\r\n  <div class=\"app-container\">\r\n    <!-- Note that row-key is necessary to get a correct row order. -->\r\n    <el-table ref=\"dragTable\" v-loading=\"listLoading\" :data=\"list\" row-key=\"id\" border fit highlight-current-row style=\"width: 100%\">\r\n      <el-table-column align=\"center\" label=\"ID\" width=\"65\">\r\n        <template slot-scope=\"{row}\">\r\n          <span>{{ row.id }}</span>\r\n        </template>\r\n      </el-table-column>\r\n\r\n      <el-table-column width=\"180px\" align=\"center\" label=\"Date\">\r\n        <template slot-scope=\"{row}\">\r\n          <span>{{ row.timestamp | parseTime('{y}-{m}-{d} {h}:{i}') }}</span>\r\n        </template>\r\n      </el-table-column>\r\n\r\n      <el-table-column min-width=\"300px\" label=\"Title\">\r\n        <template slot-scope=\"{row}\">\r\n          <span>{{ row.title }}</span>\r\n        </template>\r\n      </el-table-column>\r\n\r\n      <el-table-column width=\"110px\" align=\"center\" label=\"Author\">\r\n        <template slot-scope=\"{row}\">\r\n          <span>{{ row.author }}</span>\r\n        </template>\r\n      </el-table-column>\r\n\r\n      <el-table-column width=\"100px\" label=\"Importance\">\r\n        <template slot-scope=\"{row}\">\r\n          <svg-icon v-for=\"n in + row.importance\" :key=\"n\" icon-class=\"star\" class=\"icon-star\" />\r\n        </template>\r\n      </el-table-column>\r\n\r\n      <el-table-column align=\"center\" label=\"Readings\" width=\"95\">\r\n        <template slot-scope=\"{row}\">\r\n          <span>{{ row.pageviews }}</span>\r\n        </template>\r\n      </el-table-column>\r\n\r\n      <el-table-column class-name=\"status-col\" label=\"Status\" width=\"110\">\r\n        <template slot-scope=\"{row}\">\r\n          <el-tag :type=\"row.status | statusFilter\">\r\n            {{ row.status }}\r\n          </el-tag>\r\n        </template>\r\n      </el-table-column>\r\n\r\n      <el-table-column align=\"center\" label=\"Drag\" width=\"80\">\r\n        <template slot-scope=\"{}\">\r\n          <svg-icon class=\"drag-handler\" icon-class=\"drag\" />\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n    <!-- $t is vue-i18n global function to translate lang (lang in @/lang)  -->\r\n    <div class=\"show-d\">\r\n      <el-tag style=\"margin-right:12px;\">{{ $t('table.dragTips1') }} :</el-tag> {{ oldList }}\r\n    </div>\r\n    <div class=\"show-d\">\r\n      <el-tag>{{ $t('table.dragTips2') }} :</el-tag> {{ newList }}\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { fetchList } from '@/api/article'\r\nimport Sortable from 'sortablejs'\r\n\r\nexport default {\r\n  name: 'DragTable',\r\n  filters: {\r\n    statusFilter(status) {\r\n      const statusMap = {\r\n        published: 'success',\r\n        draft: 'info',\r\n        deleted: 'danger'\r\n      }\r\n      return statusMap[status]\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      list: null,\r\n      total: null,\r\n      listLoading: true,\r\n      listQuery: {\r\n        page: 1,\r\n        limit: 10\r\n      },\r\n      sortable: null,\r\n      oldList: [],\r\n      newList: []\r\n    }\r\n  },\r\n  created() {\r\n    this.getList()\r\n  },\r\n  methods: {\r\n    async getList() {\r\n      this.listLoading = true\r\n      const { data } = await fetchList(this.listQuery)\r\n      this.list = data.items\r\n      this.total = data.total\r\n      this.listLoading = false\r\n      this.oldList = this.list.map(v => v.id)\r\n      this.newList = this.oldList.slice()\r\n      this.$nextTick(() => {\r\n        this.setSort()\r\n      })\r\n    },\r\n    setSort() {\r\n      const el = this.$refs.dragTable.$el.querySelectorAll('.el-table__body-wrapper > table > tbody')[0]\r\n      this.sortable = Sortable.create(el, {\r\n        ghostClass: 'sortable-ghost', // Class name for the drop placeholder,\r\n        setData: function(dataTransfer) {\r\n          // to avoid Firefox bug\r\n          // Detail see : https://github.com/RubaXa/Sortable/issues/1012\r\n          dataTransfer.setData('Text', '')\r\n        },\r\n        onEnd: evt => {\r\n          const targetRow = this.list.splice(evt.oldIndex, 1)[0]\r\n          this.list.splice(evt.newIndex, 0, targetRow)\r\n\r\n          // for show the changes, you can delete in you code\r\n          const tempIndex = this.newList.splice(evt.oldIndex, 1)[0]\r\n          this.newList.splice(evt.newIndex, 0, tempIndex)\r\n        }\r\n      })\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style>\r\n.sortable-ghost{\r\n  opacity: .8;\r\n  color: #fff!important;\r\n  background: #42b983!important;\r\n}\r\n</style>\r\n\r\n<style scoped>\r\n.icon-star{\r\n  margin-right:2px;\r\n}\r\n.drag-handler{\r\n  width: 20px;\r\n  height: 20px;\r\n  cursor: pointer;\r\n}\r\n.show-d{\r\n  margin-top: 15px;\r\n}\r\n</style>\r\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiEA,SAAAA,SAAA;AACA,OAAAC,QAAA;AAEA;EACAC,IAAA;EACAC,OAAA;IACAC,YAAA,WAAAA,aAAAC,MAAA;MACA,IAAAC,SAAA;QACAC,SAAA;QACAC,KAAA;QACAC,OAAA;MACA;MACA,OAAAH,SAAA,CAAAD,MAAA;IACA;EACA;EACAK,IAAA,WAAAA,KAAA;IACA;MACAC,IAAA;MACAC,KAAA;MACAC,WAAA;MACAC,SAAA;QACAC,IAAA;QACAC,KAAA;MACA;MACAC,QAAA;MACAC,OAAA;MACAC,OAAA;IACA;EACA;EACAC,OAAA,WAAAA,QAAA;IACA,KAAAC,OAAA;EACA;EACAC,OAAA;IACAD,OAAA,WAAAA,QAAA;MAAA,IAAAE,KAAA;MAAA,OAAAC,iBAAA,eAAAC,mBAAA,GAAAC,IAAA,UAAAC,QAAA;QAAA,IAAAC,gBAAA,EAAAlB,IAAA;QAAA,OAAAe,mBAAA,GAAAI,IAAA,UAAAC,SAAAC,QAAA;UAAA,kBAAAA,QAAA,CAAAC,IAAA,GAAAD,QAAA,CAAAE,IAAA;YAAA;cACAV,KAAA,CAAAV,WAAA;cAAAkB,QAAA,CAAAE,IAAA;cAAA,OACAjC,SAAA,CAAAuB,KAAA,CAAAT,SAAA;YAAA;cAAAc,gBAAA,GAAAG,QAAA,CAAAG,IAAA;cAAAxB,IAAA,GAAAkB,gBAAA,CAAAlB,IAAA;cACAa,KAAA,CAAAZ,IAAA,GAAAD,IAAA,CAAAyB,KAAA;cACAZ,KAAA,CAAAX,KAAA,GAAAF,IAAA,CAAAE,KAAA;cACAW,KAAA,CAAAV,WAAA;cACAU,KAAA,CAAAL,OAAA,GAAAK,KAAA,CAAAZ,IAAA,CAAAyB,GAAA,WAAAC,CAAA;gBAAA,OAAAA,CAAA,CAAAC,EAAA;cAAA;cACAf,KAAA,CAAAJ,OAAA,GAAAI,KAAA,CAAAL,OAAA,CAAAqB,KAAA;cACAhB,KAAA,CAAAiB,SAAA;gBACAjB,KAAA,CAAAkB,OAAA;cACA;YAAA;YAAA;cAAA,OAAAV,QAAA,CAAAW,IAAA;UAAA;QAAA,GAAAf,OAAA;MAAA;IACA;IACAc,OAAA,WAAAA,QAAA;MAAA,IAAAE,MAAA;MACA,IAAAC,EAAA,QAAAC,KAAA,CAAAC,SAAA,CAAAC,GAAA,CAAAC,gBAAA;MACA,KAAA/B,QAAA,GAAAhB,QAAA,CAAAgD,MAAA,CAAAL,EAAA;QACAM,UAAA;QAAA;QACAC,OAAA,WAAAA,QAAAC,YAAA;UACA;UACA;UACAA,YAAA,CAAAD,OAAA;QACA;QACAE,KAAA,WAAAA,MAAAC,GAAA;UACA,IAAAC,SAAA,GAAAZ,MAAA,CAAAhC,IAAA,CAAA6C,MAAA,CAAAF,GAAA,CAAAG,QAAA;UACAd,MAAA,CAAAhC,IAAA,CAAA6C,MAAA,CAAAF,GAAA,CAAAI,QAAA,KAAAH,SAAA;;UAEA;UACA,IAAAI,SAAA,GAAAhB,MAAA,CAAAxB,OAAA,CAAAqC,MAAA,CAAAF,GAAA,CAAAG,QAAA;UACAd,MAAA,CAAAxB,OAAA,CAAAqC,MAAA,CAAAF,GAAA,CAAAI,QAAA,KAAAC,SAAA;QACA;MACA;IACA;EACA;AACA"}]}